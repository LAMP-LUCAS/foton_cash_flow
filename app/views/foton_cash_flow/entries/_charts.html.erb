<% # plugins/foton_cash_flow/app/views/foton_cash_flow/entries/_charts.html.erb %>

<div class="charts">
  <h3><%= l(:label_cash_flow_charts) %></h3>
  <div style="width: 800px; margin: auto;">
    <canvas id="bar-chart"></canvas>
  </div>
  <div style="width: 400px; margin: auto;">
    <canvas id="pie-chart"></canvas>
  </div>
</div>

<% content_for :header_tags do %>
  <%= javascript_include_tag 'chart.min.js' %>
  <script type="text/javascript">
    document.addEventListener('DOMContentLoaded', function() {
      // Bar Chart
      var barCtx = document.getElementById('bar-chart');
      if (barCtx) {
        new Chart(barCtx, {
          type: 'bar',
          data: {
            labels: <%= bar_chart_labels.to_json.html_safe %>,
            datasets: [
              { label: '<%= l(:label_total_revenue) %>', data: <%= bar_chart_revenue.to_json.html_safe %>, backgroundColor: 'rgba(75, 192, 192, 0.6)' },
              { label: '<%= l(:label_total_expense) %>', data: <%= bar_chart_expense.to_json.html_safe %>, backgroundColor: 'rgba(255, 99, 132, 0.6)' }
            ]
          },
          options: {
            responsive: true,
            scales: { y: { beginAtZero: true } }
          }
        });
      }

      // Pie Chart
      var pieCtx = document.getElementById('pie-chart');
      if (pieCtx) {
        new Chart(pieCtx, {
          type: 'pie',
          data: {
            labels: <%= pie_chart_labels.to_json.html_safe %>,
            datasets: [{
              data: <%= pie_chart_data.to_json.html_safe %>,
              backgroundColor: [
                'rgba(255, 99, 132, 0.6)', 'rgba(54, 162, 235, 0.6)', 'rgba(255, 206, 86, 0.6)',
                'rgba(75, 192, 192, 0.6)', 'rgba(153, 102, 255, 0.6)', 'rgba(255, 159, 64, 0.6)'
              ]
            }]
          },
          options: {
            responsive: true
          }
        });
      }
    });
  </script>
<% end %>

<% # fim dos charts %>
