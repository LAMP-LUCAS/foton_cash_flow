/* plugins/foton_cash_flow/assets/stylesheets/cash_flow_main.css
/*
 * Foton Cash Flow - Folha de Estilos Principal
 * Versão: 2.0
 * Descrição: Estilos unificados para o plugin de Fluxo de Caixa.
*/

/* ==========================================================================
   1. VARIÁVEIS GLOBAIS E RESET
   ========================================================================== */
:root {
  /* Cores Primárias */
  --primary-color: #3F51B5;
  --primary-hover: #303F9F;
  --text-on-primary: #FFFFFF;

  /* Cores de Feedback */
  --success-color: #28a745;
  --warning-color: #ffc107;
  --error-color: #dc3545;

  /* Cores de Fundo e Texto */
  --background-white: #fff;
  --background-light: #f8f9fa;
  --text-color: #333333;
  --text-light: #6c757d;
  --border-color: #e0e0e0;

  /* Cores para Pílulas (Tags) */
  --pill-bg-green: rgba(40, 167, 69, 0.1);
  --pill-text-green: #28a745;
  --pill-bg-red: rgba(220, 53, 69, 0.1);
  --pill-text-red: #dc3545;
  --pill-bg-blue: rgba(0, 123, 255, 0.1);
  --pill-text-blue: #007bff;
  --pill-bg-gray: rgba(108, 117, 125, 0.15);
  --pill-text-gray: #6c757d;

  /* Métricas e Efeitos */
  --border-radius: 6px;
  --box-shadow: 0 2px 8px rgba(0, 0, 0, 0.08);
  --transition: all 0.2s ease-in-out;
}

/* ==========================================================================
   2. LAYOUT PRINCIPAL
   ========================================================================== */
.cash-flow-page {
  /* Adiciona padding horizontal para garantir a margem nas laterais */
  padding-left: 1vw;
  padding-right: 1vw;
}

.cf-header {
  display: flex;
  justify-content: space-between;
  align-items: center;
  margin-bottom: 24px;
  padding-bottom: 16px;
  border-bottom: 1px solid var(--border-color);
}

.cf-main-content {
  display: flex;
  justify-content: space-between;
}

/* NOVO: Wrapper para o conteúdo principal (tabela e sumário) */
.cf-primary-content {
  min-width: 80%;
  flex-direction: column;
  padding-bottom: 1rem;
  margin-bottom: 1vh;
  align-items: flex-start;
}

.cf-summary-section {
  min-width: 20%;
  min-height: 100%;
  margin-left: 1vw;
  flex-shrink: 0;
  position: sticky; /* Mantém o sumário visível ao rolar */

}

/* ==========================================================================
   3. COMPONENTES (Botões, Cards, Dropdowns, Pílulas)
   ========================================================================== */

/* --- Botões --- */
.cf-btn {
  display: inline-flex;
  align-items: center;
  justify-content: center;
  gap: 8px;
  padding: 8px 16px;
  border-radius: var(--border-radius);
  border: 1px solid transparent;
  font-weight: 500;
  cursor: pointer;
  transition: var(--transition);
  text-decoration: none !important;
}
.cf-btn:hover {
  transform: translateY(-1px);
}
.cf-btn-primary {
  background: var(--primary-color);
  color: var(--text-on-primary);
  border-color: var(--primary-color);
}
.cf-btn-primary:hover {
  background: var(--primary-hover);
  border-color: var(--primary-hover);
}
.cf-btn-secondary {
  background: var(--background-white);
  color: var(--text-color);
  border-color: var(--border-color);
}
.cf-btn-secondary:hover {
  background: var(--background-light);
  border-color: #ccc;
}
.cf-btn-danger {
  background: var(--error-color);
  color: var(--text-on-primary);
  border-color: var(--error-color);
}

/* --- Cards de Sumário --- */
.cf-summary {
  display: flex;
  flex-direction: column;
  gap: 16px;
}
.cf-card {
  background: var(--background-white);
  border-radius: var(--border-radius);
  border: 1px solid var(--border-color);
  padding: 16px;
  transition: transform 0.2s ease-in-out, box-shadow 0.2s ease-in-out; /* Adiciona transição suave */
}
.cf-card:hover {
  transform: translateY(-4px) scale(1.02); /* Efeito de "levantar" e crescer */
  box-shadow: 0 8px 16px rgba(0, 0, 0, 0.12); /* Sombra mais destacada */
  z-index: 10; /* Garante que o card fique sobre os outros ao crescer */
}
.cf-card-label {
  font-size: 0.9rem;
  color: var(--text-light);
  margin-bottom: 8px;
}
.cf-card-value {
  font-size: 1.5rem;
  font-weight: 600;
}
.cf-card-value.cf-success { color: var(--success-color); }
.cf-card-value.cf-danger { color: var(--error-color); }

/* --- Menu Dropdown --- */
.cf-dropdown {
  position: relative;
  display: inline-block;
}
.cf-dropdown-menu {
  display: none;
  position: absolute;
  right: 0;
  top: calc(100% + 5px);
  background-color: var(--background-white);
  min-width: 200px;
  box-shadow: var(--box-shadow);
  z-index: 100;
  border-radius: var(--border-radius);
  border: 1px solid var(--border-color);
  overflow: hidden;
}
.cf-dropdown-menu.show { display: block; }
.cf-dropdown-item {
  color: var(--text-color);
  padding: 10px 14px;
  text-decoration: none;
  display: flex;
  align-items: center;
  gap: 10px;
}
.cf-dropdown-item:hover {
  background-color: var(--background-light);
}

/* --- Pílulas (Tags) Unificadas --- */
.cf-pill {
  display: inline-block;
  padding: 4px 10px;
  border-radius: 12px;
  font-size: 0.85em;
  font-weight: 500;
  line-height: 1.2;
  white-space: nowrap;
}
.cf-pill.type-revenue { background-color: var(--pill-bg-green); color: var(--pill-text-green); }
.cf-pill.type-expense { background-color: var(--pill-bg-red); color: var(--pill-text-red); }
.cf-pill.status { background-color: var(--pill-bg-blue); color: var(--pill-text-blue); }
.cf-pill.category { background-color: var(--pill-bg-gray); color: var(--pill-text-gray); }


/* ==========================================================================
   4. TABELA E INTERAÇÕES
   ========================================================================== */

.cf-table-container {
  border-radius: 0.8rem;
  box-shadow: 0 8px 16px rgba(0, 0, 0, 0.12);

}

.cf-table-wrapper {
  max-height: 85vh; /* ALTURA FIXA DA TABELA */
  min-height: 10vh;
  padding: 0.9rem;
  overflow-x: auto; /* Rolagem horizontal se necessário */
  overflow-y: auto; /* Rolagem vertical */
} 

.cf-table {
  /* Garante que a tabela ocupe no mínimo 100% do wrapper, mas possa expandir. */
  /* 'width: auto' permite que ela cresça com o conteúdo. */
  /* 'min-width: 100%' evita que ela pareça encolhida se houver poucas colunas. */
  width: auto;
  min-width: 100%;
}

.cf-table th, .cf-table td {
  padding: 12px 16px;
  text-align: left;
  vertical-align: middle;
  border-bottom: 1px solid var(--border-color);
}

.cf-table thead th {
  position: sticky;
  top: 0;
  background: var(--background-light);
  font-size: 0.9rem;
  font-weight: 500;
  color: var(--text-light);
  text-transform: uppercase;
  cursor: default; /* O cursor pointer vai para os ícones */
}

/*
  Solução Definitiva para Alinhamento de Cabeçalho:
  - O wrapper .th-content se torna um container de posicionamento.
  - Os ícones são posicionados de forma absoluta à direita, garantindo que nunca quebrem o layout.
*/
.th-content {
  position: relative;
  padding-right: 40px; /* Espaço para os ícones não sobreporem o texto */
  width: 100%;
  box-sizing: border-box;
}

.column-title {
  display: block; /* Garante que o título ocupe a linha */
  margin: 0.4rem;
  margin-right: 1rem;
  text-align: center;
}

.column-icons {
  position: absolute;
  right: 0;
  top: 50%;
  transform: translateY(-50%);
  display: flex;
  align-items: center;
  gap: 6px;
}

.cf-table tbody tr:hover {
  background-color: var(--background-light);
}

.cf-table .value-column.revenue { color: var(--success-color); }
.cf-table .value-column.expense { color: var(--error-color); }
.cf-table .actions-column { text-align: right; }
.cf-table .actions-column a { margin-left: 12px; }

/* --- Paginação --- */
.cf-pagination-container {
  padding: 16px;
  border-top: 1px solid var(--border-color);
}

.cf-pagination {
  display: flex;
  align-items: center;
  justify-content: center;
  gap: 10px;
  flex-wrap: wrap;
}

.cf-pagination-btn {
  display: inline-flex;
  align-items: center;
  gap: 6px;
  padding: 6px 12px;
  border: 1px solid var(--border-color);
  border-radius: 4px;
  background: white;
  color: var(--text-color);
  cursor: pointer;
  transition: all 0.2s;
}

.cf-pagination-btn:hover:not(.disabled) {
  background: var(--background-light);
  border-color: var(--primary-color);
}

.cf-pagination-btn.disabled {
  opacity: 0.5;
  cursor: not-allowed;
}

.cf-pagination-pages {
  display: flex;
  gap: 4px;
}

.cf-pagination-page {
  min-width: 32px;
  height: 32px;
  display: flex;
  align-items: center;
  justify-content: center;
  border: 1px solid var(--border-color);
  border-radius: 4px;
  background: white;
  color: var(--text-color);
  cursor: pointer;
  transition: all 0.2s;
}

.cf-pagination-page:hover:not(.active) {
  background: var(--background-light);
  border-color: var(--primary-color);
}

.cf-pagination-page.active {
  background: var(--primary-color);
  color: white;
  border-color: var(--primary-color);
}

.cf-pagination-ellipsis {
  display: flex;
  align-items: center;
  height: 32px;
  padding: 0 4px;
  color: var(--text-color);
}


/* ==========================================================================
   5. FILTROS (Estilo Notion)
   ========================================================================== */

/* NOVO: Estilo unificado para ícones no cabeçalho */
/*
  Regra explícita para garantir que os ícones sejam renderizados.
  Isso previne que eles "colapsem" para tamanho zero se os estilos
  base do Redmine forem insuficientes ou entrarem em conflito.
  As classes .icon, .icon-filter, etc., do Redmine fornecem o caractere do ícone
  via pseudo-elemento ::before.
*/
.cf-filter-icon, .cf-sort-icon {
  opacity: 0.5;
  transition: var(--transition);
  cursor: pointer;
  font-weight: bold;
}

/* Efeito de hover nos ícones */
.column-icons:hover .cf-filter-icon,
.column-icons:hover .cf-sort-icon {
  opacity: 1;
}

/* Ícone de filtro ativo */
.cf-table thead th .cf-filter-icon.active {
  opacity: 1;
  color: var(--primary-color);
}

/* --- Barra de Filtros Ativos --- */
#cf-active-filters-bar {
  padding: 5px 5px 12px 5px;
  display: flex;
  flex-wrap: wrap;
  gap: 10px;
  min-height: 0px; /* Garante espaço mesmo quando vazia */
}

/* --- Pílula de Filtro Ativo --- */
.cf-filter-pill {
  display: flex;
  align-items: center;
  gap: 8px;
  background-color: var(--background-light);
  border: 1px solid var(--border-color);
  border-radius: var(--border-radius);
  padding: 4px 8px;
  font-size: 0.9em;
  cursor: pointer;
  transition: var(--transition);
  box-shadow: 0 8px 16px rgba(0, 0, 0, 0.12);

}
.cf-filter-pill:hover {
  transform: translateY(-1.5px) scale(1.01);
  box-shadow: 0 9px 6px rgba(0, 0, 0, 0.24);
  border-color: #ccc;
  /*background-color: #eef0f2;*/
}
.cf-filter-pill .pill-remove-btn {
  /* Garante que o ícone 'x' seja visível e clicável */
  display: inline-flex;
  align-items: center;
  justify-content: center;
  width: 16px;
  height: 16px;
  background: rgba(0,0,0,0.08);
  border: none;
  border-radius: 50%;
  cursor: pointer;
  padding: 0;
  margin-left: 4px;
  font-size: 1em;
  line-height: 1;
  color: var(--text-light);
  transition: var(--transition);
}
.cf-filter-pill:hover .pill-remove-btn {
  background: rgba(0,0,0,0.15);
  color: var(--text-color);
}

/* --- Botão de Limpar Todos os Filtros --- */
.cf-clear-all-btn {
  background: none;
  border: none;
  color: var(--primary-color);
  text-decoration: underline;
  cursor: pointer;
  font-size: 0.9em;
  padding: 4px 8px;
  margin-left: auto; /* Alinha o botão à direita da barra de filtros */
}
.cf-clear-all-btn:hover {
  color: var(--primary-hover);
}

/* --- Popup de Filtro --- */
.cf-filter-popup {
  display: none; /* Oculto por padrão, controlado por JS */
  position: absolute;
  z-index: 1010;
  background: var(--background-white);
  border: 1px solid var(--border-color);
  border-radius: var(--border-radius);
  box-shadow: var(--box-shadow);
  width: 320px;
}
.cf-popup-content {
  padding: 12px;
}
.cf-popup-content p {
  margin: 0 0 12px 0;
  color: var(--text-light);
}
.cf-popup-content p strong {
  color: var(--text-color);
}

/* Estilos para o filtro de data */
.cf-filter-date-range {
  display: flex;
  align-items: center;
  gap: 8px;
  margin-bottom: 12px;
}
.cf-filter-date-range input[type="date"] {
  flex: 1;
  padding: 8px;
  border: 1px solid var(--border-color);
  border-radius: var(--border-radius);
  font-family: inherit;
  font-size: 0.9em;
}

/* Estilos para a lista de checkboxes */
.cf-filter-checklist {
  max-height: 200px;
  overflow-y: auto;
  border: 1px solid var(--border-color);
  border-radius: var(--border-radius);
  padding: 4px;
  margin-bottom: 12px;
}
.cf-filter-checklist-item {
  display: flex;
  align-items: center;
  gap: 8px;
  padding: 6px 8px;
  border-radius: 4px;
  cursor: pointer;
  transition: background-color 0.2s;
}
.cf-filter-checklist-item:hover {
  background-color: var(--background-light);
}

.cf-filter-popup-body {
  padding: 12px;
}
.cf-filter-popup-footer {
  padding: 8px 12px;
  border-top: 1px solid var(--border-color);
  display: flex;
  justify-content: space-between;
}
.cf-filter-group {
  display: flex;
  flex-direction: column;
  gap: 8px;
}
.cf-filter-group select,
.cf-filter-group input[type="text"],
.cf-filter-group input[type="number"],
.cf-filter-group input[type="date"] {
  width: 100%;
  box-sizing: border-box;
  padding: 8px;
  border: 1px solid var(--border-color);
  border-radius: var(--border-radius);
}
.cf-filter-number-inputs, .cf-filter-date-inputs {
  display: flex;
  align-items: center;
  gap: 8px;
}


/* --- Pílulas da Tabela (Tags) --- */
/* Estilo base para pílulas usadas dentro da tabela para consistência visual. */
.cf-table .status-tag,
.cf-table .transaction-tag,
.cf-table .category-tag {
  display: inline-block;
  padding: 4px 10px;
  border-radius: 12px;
  font-size: 0.85em;
  font-weight: 500;
  line-height: 1.2;
  white-space: nowrap;
  border: 1px solid transparent;
  color: var(--text-on-primary); /* Branco, para bom contraste com fundos coloridos */
  transition: all 0.2s ease-in-out;
  cursor: pointer;
}

/* Efeito de hover para todas as pílulas da tabela */
.cf-table .status-tag:hover,
.cf-table .transaction-tag:hover,
.cf-table .category-tag:hover {
  transform: translateY(-2px) scale(1.05);
  box-shadow: 0 4px 8px rgba(0, 0, 0, 0.2);
  filter: brightness(110%);
  font-weight: 600;
  text-shadow: 0 1px 1px rgba(0, 0, 0, 0.3);
}

/* Cores para pílulas de transação */
/* CORREÇÃO: O HTML gera a classe 'revenue', não 'income'. */
.cf-table .transaction-tag.revenue {
  background-color: var(--success-color);
}
.cf-table .transaction-tag.expense {
  background-color: var(--error-color);
}

/* ADIÇÃO: Cores para pílulas de status, agora controladas por CSS para robustez. */
/* As classes (paid, pending, etc.) são geradas pelo `issue.status.name.parameterize` no HTML. */
.cf-table .status-tag.paid {
  background-color: var(--primary-color);
}
.cf-table .status-tag.pending {
  background-color: var(--warning-color);
  color: #333; /* Texto escuro para melhor contraste em fundo amarelo */
}
.cf-table .status-tag.rejected {
  background-color: var(--error-color);
}

/* ==========================================================================
   6. MODAIS
   ========================================================================== */
.cf-modal-overlay {
  position: fixed;
  top: 0;
  left: 0;
  width: 100%;
  height: 100%;
  background-color: rgba(0, 0, 0, 0.5);
  display: none; /* Alterado para 'none' por padrão */
  align-items: center;
  justify-content: center;
  z-index: 1050;
}
.cf-modal-overlay.show {
  display: flex; /* Mostra o modal */
}
.cf-modal-content {
  background: var(--background-white);
  border-radius: var(--border-radius);
  box-shadow: 0 5px 15px rgba(0,0,0,0.2);
  width: 90%;
  max-width: 500px;
}
.cf-modal-header {
  padding: 16px;
  border-bottom: 1px solid var(--border-color);
  display: flex;
  justify-content: space-between;
  align-items: center;
}
.cf-modal-header h5 { margin: 0; font-size: 1.2rem; }
.cf-modal-close-btn { background: none; border: none; font-size: 1.5rem; cursor: pointer; opacity: 0.5; }
.cf-modal-close-btn:hover { opacity: 1; }
.cf-modal-body { padding: 16px; }
.cf-modal-footer {
  padding: 16px;
  border-top: 1px solid var(--border-color);
  display: flex;
  justify-content: flex-end;
  gap: 12px;
}

/* ==========================================================================
   7. GRÁFICOS
   ========================================================================== */
.cf-charts-container {
  display: grid;
  /* REVERTIDO: Usa auto-fit para se adaptar a telas ultrawide, criando mais colunas se houver espaço. */
  grid-template-columns: repeat(auto-fit, minmax(350px, 1fr));
  gap: 24px;
}

.cf-chart-card {
  background: var(--background-white);
  border-radius: var(--border-radius);
  border: 1px solid var(--border-color);
  padding: 16px;
  transition: all 0.3s ease-in-out; /* Transição para todas as propriedades */
  display: flex; /* SEMPRE será um container flex */
  flex-direction: column; /* Título em cima, gráfico embaixo */
  aspect-ratio: 1 / 1; /* O PRÓPRIO CARD define a proporção */
  position: relative; /* Necessário para posicionar os ícones de ação */
}
.cf-chart-title {
  font-size: 1.1rem;
  font-weight: 600;
  margin-bottom: 16px;
}

/*
  O wrapper do gráfico agora não precisa mais de aspect-ratio.
  Ele simplesmente cresce para preencher o espaço que o card (seu pai flex)
  deixa disponível após o título.
*/
.chart-wrapper {
  position: relative;
  flex-grow: 1; /* Ocupa todo o espaço vertical restante */
  min-height: 0; /* Previne problemas de overflow em containers flex */
}
.cf-chart-card--pie {
  aspect-ratio: 1 / 1; /* Apenas o card de pizza tem proporção diferente */
}

.cf-chart-card:hover {
  transform: translateY(-3px);
  box-shadow: var(--box-shadow);
}

/* ==========================================================================
   8. RESPONSIVIDADE
   ========================================================================== */
@media (max-width: 992px) {
  .cf-main-content {
    flex-direction: column;
  }
  .cf-summary-section {
    width: 100%;
    margin-bottom: 2rem;
    position: static; /* Remove o sticky em telas menores */
  }
  .cf-summary {
    flex-direction: row;
    justify-content: space-around;
  }
  .cf-summary .cf-card {
    flex: 1;
  }
  .cf-table-wrapper {
    max-height: none; /* Remove altura fixa em telas menores */
  }
}

/* ==========================================================================
   9. FUNCIONALIDADE DE MAXIMIZAR GRÁFICO
   ========================================================================== */

/* Previne o scroll do body quando o modal/gráfico está aberto */
body.cf-modal-open {
  overflow: hidden;
}

/* Backdrop para focar no gráfico maximizado */
.cf-chart-backdrop {
  position: fixed;
  top: 0;
  left: 0;
  width: 100vw;
  height: 100vh;
  background-color: rgba(0, 0, 0, 0.65);
  z-index: 2000;
  opacity: 0;
  visibility: hidden;
  transition: opacity 0.3s ease, visibility 0.3s ease;
}
.cf-chart-backdrop.show {
  opacity: 1;
  visibility: visible;
}

/* Estilo do card quando maximizado */
.cf-chart-card.maximized {
  position: fixed;
  top: 50%;
  left: 50%;
  transform: translate(-50%, -50%);
  width: 85vw;
  height: 85vh;
  z-index: 2001;
  cursor: default;
  display: flex;
  flex-direction: column;
  aspect-ratio: auto; /* Remove o aspect-ratio quando maximizado */
}

/* Contêiner para os botões de ação do gráfico (Maximizar/Fechar) */
.cf-chart-actions {
  position: absolute;
  top: 8px;
  right: 8px;
  z-index: 5;
  display: flex;
  gap: 6px;
}

/* Estilo base para os botões de ação */
.cf-chart-maximize-btn,
.cf-chart-close-btn {
  background: rgba(255, 255, 255, 0.7);
  border: 1px solid var(--border-color);
  border-radius: 50%;
  width: 28px;
  height: 28px;
  display: flex;
  align-items: center;
  justify-content: center;
  cursor: pointer;
  transition: all 0.2s ease;
  color: var(--text-light);
  font-size: 1.2rem;
  line-height: 1;
}
.cf-chart-maximize-btn:hover,
.cf-chart-close-btn:hover {
  background: var(--background-white);
  color: var(--text-color);
  transform: scale(1.1);
  box-shadow: var(--box-shadow);
}

/* Faz o container do canvas crescer para preencher o card maximizado */
.cf-chart-card.maximized .chart-wrapper {
  flex-grow: 1;
  position: relative; /* Essencial para o Chart.js responsivo */
}

/* Lógica de visibilidade dos ícones */
.cf-chart-card .cf-chart-maximize-btn {
  display: flex; /* Visível no estado normal */
}
.cf-chart-card.maximized .cf-chart-maximize-btn {
  display: none; /* Oculto quando maximizado */
}
.cf-chart-card .cf-chart-close-btn {
  display: none; /* Oculto no estado normal */
}
.cf-chart-card.maximized .cf-chart-close-btn {
  display: flex; /* Visível quando maximizado */
}
